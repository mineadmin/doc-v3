# ビルドとプレビュー

## ビルド（パッケージング）
プロジェクトの開発が完了し、サーバーにデプロイする際には、フロントエンドプロジェクトをビルドしてパッケージ化する必要があります。

`pnpm run build` コマンドを実行してビルドを行います。パッケージングが成功すると、`./web` ディレクトリ下に `dist` フォルダが生成され、その中にパッケージ化された静的ファイルが格納されます。

::: info ヒント
アクセスアドレスがドメインのルートノードでない場合（例: `https://www.example.com/app`）、`環境変数ファイル` 内の `VITE_APP_ROOT_BASE` オプションを `/app` に変更する必要があります。そうしないとリソース参照エラーが発生する可能性があります。
:::

## プレビュー
ビルドしてパッケージ化したプロジェクトが正常に動作することを確認するため、通常はローカルでテストを行います。

この場合、`pnpm run serve` コマンドを実行してパッケージ化されたプロジェクトをプレビューし、実際の状況でバックエンドサーバーにアクセスすることができます。

## 圧縮
`環境変数ファイル` で `VITE_BUILD_COMPRESS` を設定すると、ビルド時に `.gz` または `.br` ファイルを生成できます。ただし、どちらも `nginx` に特定のモジュールをインストールし、有効にする必要があります。
```yaml
# gzip のみを有効にする
VITE_BUILD_COMPRESS = gzip

# brotli のみを有効にする（brotli は gzip よりも高い圧縮率のアルゴリズムです）
VITE_BUILD_COMPRESS = brotli

# または両方を有効にすることも可能で、共存できます
VITE_BUILD_COMPRESS = gzip,brotli
```