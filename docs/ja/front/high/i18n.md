# 国際化設定

フロントエンドのプロジェクトには `Vue i18n` が組み込まれており、リクエスト時に現在の言語に応じてバックエンドに対応する言語のテキストを自動的にリクエストします。バックエンド部分についてはここでは解説せず、興味があればソースコードを参照してください。

フロントエンドは現在 `中国語（簡体字）、中国語（繁体字）、英語` の3つの言語パックをサポートしています。

## おすすめプラグイン

- `vscode` を使用している場合、[i18n Ally](https://marketplace.visualstudio.com/items?itemName=Lokalise.i18n-ally) のインストールを推奨します
- `webStorm` を使用している場合、[Easy i18n](https://plugins.jetbrains.com/plugin/16316-easy-i18n) のインストールを推奨します

上記のプラグインは言語パックの充実に役立ちます。

## 言語パックの定義

::: tip 必読
`Vue i18n` は2種類の言語パックタイプをサポートしています。**グローバル言語パック** と **ローカル言語パック** です。ローカル言語パックはファイル内の言語パックとも呼ばれ、`.vue` 拡張子のファイル内でのみ使用されます。グローバル言語パックは `.vue`、`.tsx`、`.jsx` タイプのファイルをサポートします。

言語パックの定義には `yaml` フォーマットの構文を使用しており、`json` よりも書きやすくなっています。

他の言語を拡張する場合、フォーマットに注意してください。フォーマットは `言語識別子[本言語名]` です。例：
- en[English].yaml
- zh_CN[简体中文].yaml
- zh_TW[繁體中文].yaml
:::

### グローバル言語パック
グローバル言語パックは3つの形式で保存され、システムによって自動的にスキャンされてインポートされます。
- `src/locales` ディレクトリ内
- `src/modules/<モジュール名>/locales` ディレクトリ内
- `src/plugins/<プラグイン名>/locales` ディレクトリ内

::: danger 注意事項
**モジュール** と **プラグイン** のグローバル言語パックは `src/locales` 内のファイル名と一致させる必要があります。一致しない場合、コンソールに `key` が見つからない警告が表示されます（この警告は煩わしいです）。
:::

### ローカル言語パック
プロジェクト内のすべての `.vue` ファイルはローカル言語パックをサポートしています。`.vue` ファイル内に `i18n` タグを定義するだけで使用できます。例：

```vue
<i18n lang="yaml">
zh_CN:
  hello: 你好
zh_TW:
  hello: 你好
en:
  hello: hello
</i18n>

<script setup lang="ts">
</script>

<template>
</template>

<style>
</style>
```

## 使用方法

まず、手動で `Vue i18n` をインポートし、`i18n` オブジェクトを取得してから、`i18n` オブジェクトの `t` メソッドを使用してテキストを取得することができます。例：

```ts
import { i18n } from 'vue-i18n'

// グローバルモード
const { t } = i18n()

// ローカルモード
const { t } = i18n({
  inheritLocale: true,
  useScope: 'local',
})
```

ただし、フロントエンドプロジェクトでは `i18n` オブジェクトを取得する方法が既にカプセル化されており、`setup` 関数内で `useTrans()` メソッドを使用するだけで済みます。例：

```ts
// useTrans() は自動的にインポートされます
const trans = useTrans()

// useTrans() はオブジェクトを返し、グローバルとローカルの2つのオブジェクトを含みます：
// trans.globalTrans と trans.localTrans

trans.globalTrans('global.title')
trans.localTrans('title')

// 直接使用することも可能で、デフォルトでは最初にグローバルの key を探し、見つからない場合はローカルの key を探します
useTrans('title')
```

さらに、`useLocalTrans()` というメソッドもあります。これはローカルの `i18n` オブジェクトのみを返し、手動でインポートする必要があります。例：

```ts
import useLocalTrans from '@/hooks/useLocalTrans'

// このファイル内の key のみを探します
const t = useLocalTrans()

// 2つの使用方法
t('title')
useLocalTrans('title')
```