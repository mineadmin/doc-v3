# MineAdmin å›½é™…åŒ–é…ç½®å®Œæ•´æŒ‡å—

MineAdmin å‰ç«¯åŸºäº Vue i18n v11 æ„å»ºäº†å®Œæ•´çš„å›½é™…åŒ–è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šè¯­è¨€åˆ‡æ¢ã€åŠ¨æ€è¯­è¨€åŒ…åŠ è½½å’Œæ¨¡å—åŒ–ç¿»è¯‘ç®¡ç†ã€‚æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç»ç³»ç»Ÿçš„å›½é™…åŒ–å®ç°æœºåˆ¶å’Œä½¿ç”¨æ–¹æ³•ã€‚

## æ¦‚è¿°

### æ”¯æŒçš„è¯­è¨€
- ç®€ä½“ä¸­æ–‡ (zh_CN) - é»˜è®¤è¯­è¨€
- ç¹ä½“ä¸­æ–‡ (zh_TW)
- è‹±æ–‡ (en)

### æ ¸å¿ƒç‰¹æ€§
- ğŸŒ å¤šè¯­è¨€åŠ¨æ€åˆ‡æ¢
- ğŸ“¦ æ¨¡å—åŒ–è¯­è¨€åŒ…ç®¡ç†
- âš¡ åŠ¨æ€è¯­è¨€åŒ…åŠ è½½
- ğŸ”§ å¼€å‘å·¥å…·é›†æˆ
- ğŸ“± å…¨å±€å’Œå±€éƒ¨ä½œç”¨åŸŸæ”¯æŒ
- ğŸ¯ TypeScript ç±»å‹å®‰å…¨

### æŠ€æœ¯æ ˆ
- **Vue i18n**: 11.1.2
- **æ„å»ºæ’ä»¶**: @intlify/unplugin-vue-i18n 6.0.3
- **è¯­è¨€æ ¼å¼**: YAML (æ”¯æŒ JSON)
- **ç±»å‹ç³»ç»Ÿ**: TypeScript

## é¡¹ç›®é…ç½®

### ç³»ç»Ÿåˆå§‹åŒ–

ç³»ç»Ÿåœ¨ `/web/src/bootstrap.ts` ä¸­åˆå§‹åŒ–å›½é™…åŒ–é…ç½®ï¼š

```typescript
// æºç ä½ç½®: web/src/bootstrap.ts:44-67
// GitHub: https://github.com/mineadmin/mineadmin/blob/master/web/src/bootstrap.ts

async function createI18nService(app: App) {
  // è‡ªåŠ¨æ‰«æè¯­è¨€åŒ…æ–‡ä»¶
  const locales: any[] = Object.entries(import.meta.glob('./locales/*.y(a)?ml')).map(([key]: any) => {
    const [, value, label] = key.match(/^.\/locales\/(\w+)\[([^[\]]+)\]\.yaml$/)
    return { label, value }
  })
  
  useUserStore().setLocales(locales)
  
  // å¤„ç†æ¶ˆæ¯æ ¼å¼
  Object.keys(messages as any).map((name: string) => {
    const matchValue = name.match(/(\w+)/) as RegExpMatchArray | null
    if (messages && matchValue) {
      messages[matchValue[1]] = messages[name]
      delete messages[name]
    }
  })

  // åˆ›å»º i18n å®ä¾‹
  app.use(createI18n({
    legacy: false,                    // ä½¿ç”¨ Composition API
    globalInjection: true,            // å…¨å±€æ³¨å…¥
    fallbackLocale: 'zh_CN',         // å›é€€è¯­è¨€
    locale: useUserStore().getLanguage(), // å½“å‰è¯­è¨€
    silentTranslationWarn: true,      // é™é»˜ç¿»è¯‘è­¦å‘Š
    silentFallbackWarn: true,         // é™é»˜å›é€€è­¦å‘Š
    messages,                         // è¯­è¨€åŒ…æ•°æ®
  }))
}
```

## ç³»ç»Ÿæ¶æ„

### æ¶æ„å›¾

```mermaid
graph TB
    A[Vue App] --> B[Bootstrap]
    B --> C[I18n Service]
    C --> D[createI18n]
    D --> E[Global Messages]
    D --> F[Local Messages]
    
    E --> G[Core Locales]
    E --> H[Module Locales]
    E --> I[Plugin Locales]
    
    F --> J[Component i18n blocks]
    
    K[useTrans Hook] --> L[Global Translation]
    K --> M[Local Translation]
    
    N[useLocalTrans Hook] --> M
    
    G --> O[/src/locales/*.yaml]
    H --> P[/src/modules/*/locales/*.yaml]
    I --> Q[/src/plugins/*/locales/*.yaml]
    
    style A fill:#e1f5fe
    style C fill:#f3e5f5
    style K fill:#fff3e0
    style N fill:#fff3e0
```

### æ–‡ä»¶ç»“æ„

```
web/src/
â”œâ”€â”€ locales/                           # æ ¸å¿ƒè¯­è¨€åŒ…
â”‚   â”œâ”€â”€ zh_CN[ç®€ä½“ä¸­æ–‡].yaml
â”‚   â”œâ”€â”€ en[English].yaml
â”‚   â””â”€â”€ zh_TW[ç¹é«”ä¸­æ–‡].yaml
â”œâ”€â”€ modules/                           # æ¨¡å—è¯­è¨€åŒ…
â”‚   â””â”€â”€ base/
â”‚       â””â”€â”€ locales/
â”‚           â”œâ”€â”€ zh_CN[ç®€ä½“ä¸­æ–‡].yaml
â”‚           â”œâ”€â”€ en[English].yaml
â”‚           â””â”€â”€ zh_TW[ç¹é«”ä¸­æ–‡].yaml
â”œâ”€â”€ plugins/                           # æ’ä»¶è¯­è¨€åŒ…
â”‚   â””â”€â”€ mine-admin/
â”‚       â””â”€â”€ code-generator/
â”‚           â””â”€â”€ web/
â”‚               â””â”€â”€ locales/
â”‚                   â”œâ”€â”€ zh_CN[ç®€ä½“ä¸­æ–‡].yaml
â”‚                   â”œâ”€â”€ en[English].yaml
â”‚                   â””â”€â”€ zh_TW[ç¹é«”ä¸­æ–‡].yaml
â””â”€â”€ hooks/                             # å›½é™…åŒ– Hooks
    â”œâ”€â”€ auto-imports/
    â”‚   â””â”€â”€ useTrans.ts               # è‡ªåŠ¨å¯¼å…¥çš„ç¿»è¯‘ Hook
    â””â”€â”€ useLocalTrans.ts              # å±€éƒ¨ç¿»è¯‘ Hook
```

## è¯­è¨€åŒ…ç®¡ç†

### æ–‡ä»¶å‘½åè§„èŒƒ

è¯­è¨€åŒ…æ–‡ä»¶å¿…é¡»éµå¾ªç‰¹å®šæ ¼å¼ï¼š`è¯­è¨€æ ‡è¯†ç¬¦[æœ¬è¯­è¨€åç§°].yaml`

```bash
# æ­£ç¡®çš„å‘½åæ ¼å¼
zh_CN[ç®€ä½“ä¸­æ–‡].yaml
en[English].yaml  
zh_TW[ç¹é«”ä¸­æ–‡].yaml

# é”™è¯¯çš„å‘½åæ ¼å¼
zh_CN.yaml         # ç¼ºå°‘è¯­è¨€åç§°
en[è‹±æ–‡].yaml      # è¯­è¨€åç§°é”™è¯¯
zh-CN[ç®€ä½“ä¸­æ–‡].yaml  # è¯­è¨€æ ‡è¯†ç¬¦æ ¼å¼é”™è¯¯
```

### å…¨å±€è¯­è¨€åŒ…

ç³»ç»Ÿè‡ªåŠ¨æ‰«æä»¥ä¸‹ä¸‰ä¸ªä½ç½®çš„è¯­è¨€åŒ…ï¼š

1. **æ ¸å¿ƒè¯­è¨€åŒ…**: `src/locales/`
2. **æ¨¡å—è¯­è¨€åŒ…**: `src/modules/<æ¨¡å—å>/locales/`
3. **æ’ä»¶è¯­è¨€åŒ…**: `src/plugins/<æ’ä»¶å>/locales/`

::: danger é‡è¦æé†’
**æ¨¡å—** å’Œ **æ’ä»¶** ä¸‹çš„è¯­è¨€åŒ…æ–‡ä»¶åå¿…é¡»ä¸ `src/locales` ä¸‹çš„æ–‡ä»¶åå®Œå…¨ä¸€è‡´ï¼Œå¦åˆ™ä¼šå‡ºç°æ‰¾ä¸åˆ°ç¿»è¯‘é”®çš„æ§åˆ¶å°è­¦å‘Šã€‚
:::

### è¯­è¨€åŒ…å†…å®¹ç¤ºä¾‹

**æ ¸å¿ƒè¯­è¨€åŒ…ç¤ºä¾‹** (`src/locales/zh_CN[ç®€ä½“ä¸­æ–‡].yaml`)ï¼š

```yaml
# ç™»å½•è¡¨å•
loginForm:
  loginButton: ç™»å½•
  passwordPlaceholder: è¯·è¾“å…¥å¯†ç 
  codeLabel: éªŒè¯ç 
  usernameLabel: è´¦æˆ·

# CRUD æ“ä½œ
crud:
  cancel: å–æ¶ˆ
  save: ä¿å­˜
  ok: ç¡®å®š
  add: æ–°å¢
  edit: ç¼–è¾‘
  delete: åˆ é™¤
  createSuccess: åˆ›å»ºæˆåŠŸ
  updateSuccess: ä¿®æ”¹æˆåŠŸ
  delMessage: æ˜¯å¦åˆ é™¤æ‰€é€‰ä¸­æ•°æ®ï¼Ÿ

# è¡¨å•éªŒè¯
form:
  pleaseInput: è¯·è¾“å…¥{msg}
  pleaseSelect: è¯·é€‰æ‹©{msg}
  requiredInput: '{msg}å¿…å¡«'
```

### å±€éƒ¨è¯­è¨€åŒ…

åœ¨ Vue ç»„ä»¶ä¸­å®šä¹‰å±€éƒ¨è¯­è¨€åŒ…ï¼š

```vue
<template>
  <div>
    <h1>{{ t('welcome') }}</h1>
    <p>{{ t('description') }}</p>
  </div>
</template>

<script setup lang="ts">
const { t } = useLocalTrans()
</script>

<i18n lang="yaml">
zh_CN:
  welcome: æ¬¢è¿ä½¿ç”¨
  description: è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹é¡µé¢
zh_TW:
  welcome: æ­¡è¿ä½¿ç”¨
  description: é€™æ˜¯ä¸€å€‹ç¤ºä¾‹é é¢
en:
  welcome: Welcome
  description: This is a sample page
</i18n>
```

## Hook ç³»ç»Ÿè¯¦è§£

### useTrans Hook

**æºç ä½ç½®**: `web/src/hooks/auto-imports/useTrans.ts`  
**GitHub**: https://github.com/mineadmin/mineadmin/blob/master/web/src/hooks/auto-imports/useTrans.ts

```typescript
import { useI18n } from 'vue-i18n'
import type { ComposerTranslation } from 'vue-i18n'

export interface TransType {
  globalTrans: ComposerTranslation
  localTrans: ComposerTranslation
}

export function useTrans(key: any | null = null): TransType | string | any {
  const global = useI18n()
  const local = useI18n({
    inheritLocale: true,
    useScope: 'local',
  })

  if (key === null) {
    return {
      localTrans: local.t,
      globalTrans: global.t,
    }
  }
  else {
    // ä¼˜å…ˆæŸ¥æ‰¾å…¨å±€ç¿»è¯‘ï¼Œç„¶åæŸ¥æ‰¾å±€éƒ¨ç¿»è¯‘
    return global.te(key) ? global.t(key) : local.te(key) ? local.t(key) : key
  }
}
```

### useLocalTrans Hook

**æºç ä½ç½®**: `web/src/hooks/useLocalTrans.ts`  
**GitHub**: https://github.com/mineadmin/mineadmin/blob/master/web/src/hooks/useLocalTrans.ts

```typescript
import { useI18n } from 'vue-i18n'
import type { ComposerTranslation } from 'vue-i18n'

export function useLocalTrans(key: any | null = null): string | ComposerTranslation | any {
  const { t } = useI18n({
    inheritLocale: true,
    useScope: 'local',
  })
  return key === null ? t as ComposerTranslation : t(key) as string
}
```

## ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ç”¨æ³•

#### 1. å…¨å±€å’Œå±€éƒ¨ç¿»è¯‘å¯¹è±¡

```vue
<script setup lang="ts">
import type { TransType } from '@/hooks/auto-imports/useTrans.ts'

// è·å–ç¿»è¯‘å¯¹è±¡
const i18n = useTrans() as TransType
const t = i18n.globalTrans  // å…¨å±€ç¿»è¯‘å‡½æ•°
const localT = i18n.localTrans  // å±€éƒ¨ç¿»è¯‘å‡½æ•°

// ä½¿ç”¨ç¤ºä¾‹
const title = t('crud.createSuccess')  // "åˆ›å»ºæˆåŠŸ"
const localTitle = localT('welcome')   // ç»„ä»¶å†…å®šä¹‰çš„ç¿»è¯‘
</script>
```

#### 2. ç›´æ¥è°ƒç”¨ç¿»è¯‘

```typescript
// æ™ºèƒ½ç¿»è¯‘ï¼šä¼˜å…ˆå…¨å±€ï¼Œå›é€€åˆ°å±€éƒ¨
const message = useTrans('crud.updateSuccess')  // "ä¿®æ”¹æˆåŠŸ"

// ä»…ä½¿ç”¨å±€éƒ¨ç¿»è¯‘
const localMessage = useLocalTrans('description')
```

### å®é™…é¡¹ç›®æ¡ˆä¾‹

**æºç ä½ç½®**: `web/src/modules/base/views/permission/user/index.vue`  
**GitHub**: https://github.com/mineadmin/mineadmin/blob/master/web/src/modules/base/views/permission/user/index.vue

```vue
<script setup lang="tsx">
import type { TransType } from '@/hooks/auto-imports/useTrans.ts'

// è·å–å›½é™…åŒ–å¯¹è±¡
const i18n = useTrans() as TransType
const t = i18n.globalTrans

// å¼¹çª—é…ç½®ä¸­ä½¿ç”¨ç¿»è¯‘
const maDialog: UseDialogExpose = useDialog({
  ok: ({ formType }, okLoadingState: (state: boolean) => void) => {
    // æ ¹æ®æ“ä½œç±»å‹æ˜¾ç¤ºä¸åŒæ¶ˆæ¯
    switch (formType) {
      case 'add':
        formRef.value.add().then((res: any) => {
          res.code === ResultCode.SUCCESS 
            ? msg.success(t('crud.createSuccess'))  // "åˆ›å»ºæˆåŠŸ"
            : msg.error(res.message)
        })
        break
      case 'edit':
        formRef.value.edit().then((res: any) => {
          res.code === 200 
            ? msg.success(t('crud.updateSuccess'))  // "ä¿®æ”¹æˆåŠŸ"
            : msg.error(res.message)
        })
        break
    }
  },
})

// è¡¨æ ¼é…ç½®ä¸­ä½¿ç”¨ç¿»è¯‘
const options = ref<MaProTableOptions>({
  header: {
    mainTitle: () => t('baseUserManage.mainTitle'),
    subTitle: () => t('baseUserManage.subTitle'),
  },
})
</script>
```

### å¸¦å‚æ•°çš„ç¿»è¯‘

```vue
<template>
  <div>
    <!-- æ˜¾ç¤ºï¼šè¯·è¾“å…¥ç”¨æˆ·å -->
    <el-input :placeholder="t('form.pleaseInput', { msg: 'ç”¨æˆ·å' })" />
    
    <!-- æ˜¾ç¤ºï¼šç”¨æˆ·åå¿…å¡« -->
    <span class="error">{{ t('form.requiredInput', { msg: 'ç”¨æˆ·å' }) }}</span>
  </div>
</template>

<script setup lang="ts">
const { globalTrans: t } = useTrans()
</script>
```

### æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨

```vue
<template>
  <div>
    <!-- ä½¿ç”¨å…¨å±€å‡½æ•° $t -->
    <el-button>{{ $t('crud.save') }}</el-button>
    
    <!-- ä½¿ç”¨ Hook -->
    <el-button>{{ t('crud.cancel') }}</el-button>
  </div>
</template>
```

## é«˜çº§åŠŸèƒ½

### åŠ¨æ€è¯­è¨€åˆ‡æ¢

```typescript
// åˆ‡æ¢åˆ°è‹±æ–‡
const { locale } = useI18n()
locale.value = 'en'

// æˆ–ä½¿ç”¨ç”¨æˆ·å­˜å‚¨
const userStore = useUserStore()
userStore.setLanguage('en')
```

### æ£€æŸ¥ç¿»è¯‘é”®æ˜¯å¦å­˜åœ¨

```typescript
const { te, t } = useI18n()

// æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨
if (te('some.key')) {
  const translation = t('some.key')
} else {
  console.warn('Translation key not found: some.key')
}
```

### å¤æ•°å¤„ç†

```yaml
# è¯­è¨€åŒ…å®šä¹‰
en:
  cart:
    items: 'no items | one item | {count} items'
zh_CN:
  cart:
    items: '{count} ä¸ªå•†å“'
```

```typescript
// ä½¿ç”¨
const itemCount = ref(5)
const message = t('cart.items', itemCount.value)  // "5 ä¸ªå•†å“"
```

## æ€§èƒ½ä¼˜åŒ–

### æ‡’åŠ è½½è¯­è¨€åŒ…

```typescript
// æŒ‰éœ€åŠ è½½è¯­è¨€åŒ…
const loadLanguage = async (locale: string) => {
  try {
    const messages = await import(`../locales/${locale}[${getLocaleName(locale)}].yaml`)
    const { global } = useI18n()
    global.setLocaleMessage(locale, messages.default)
    global.locale.value = locale
  } catch (error) {
    console.error(`Failed to load language pack: ${locale}`, error)
  }
}
```

### ç¼“å­˜ä¼˜åŒ–

```typescript
// ç¼“å­˜ç¿»è¯‘ç»“æœ
const translationCache = new Map<string, string>()

const cachedT = (key: string, ...args: any[]) => {
  const cacheKey = `${key}-${JSON.stringify(args)}`
  if (translationCache.has(cacheKey)) {
    return translationCache.get(cacheKey)
  }
  
  const result = t(key, ...args)
  translationCache.set(cacheKey, result)
  return result
}
```

## è°ƒè¯•å’Œæ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ‰¾ä¸åˆ°ç¿»è¯‘é”®

**é—®é¢˜**: æ§åˆ¶å°å‡ºç°è­¦å‘Š `Not found 'xxx' key in 'zh_CN' locale messages.`

**è§£å†³æ–¹æ¡ˆ**:
```typescript
// æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨
const { te, t } = useI18n()
const safeT = (key: string, fallback: string = key) => {
  return te(key) ? t(key) : fallback
}
```

#### 2. æ¨¡å—è¯­è¨€åŒ…ä¸ç”Ÿæ•ˆ

**é—®é¢˜**: æ¨¡å—æˆ–æ’ä»¶çš„è¯­è¨€åŒ…æ²¡æœ‰è¢«åŠ è½½

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿æ–‡ä»¶åæ ¼å¼æ­£ç¡®ï¼š`zh_CN[ç®€ä½“ä¸­æ–‡].yaml`
2. æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦åœ¨æ‰«æèŒƒå›´å†…
3. éªŒè¯ YAML è¯­æ³•æ˜¯å¦æ­£ç¡®

#### 3. ç±»å‹é”™è¯¯

**é—®é¢˜**: TypeScript ç±»å‹æ£€æŸ¥å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```typescript
// ä½¿ç”¨æ­£ç¡®çš„ç±»å‹å®šä¹‰
import type { TransType } from '@/hooks/auto-imports/useTrans.ts'

const i18n = useTrans() as TransType
const t = i18n.globalTrans  // ç±»å‹å®‰å…¨çš„ç¿»è¯‘å‡½æ•°
```

### å¼€å‘å·¥å…·

#### IDE æ’ä»¶æ¨è

- **VSCode**: [i18n Ally](https://marketplace.visualstudio.com/items?itemName=Lokalise.i18n-ally)
- **WebStorm**: [Easy i18n](https://plugins.jetbrains.com/plugin/16316-easy-i18n)

#### è°ƒè¯•æŠ€å·§

```typescript
// å¯ç”¨è¯¦ç»†æ—¥å¿—
const i18n = createI18n({
  // ... å…¶ä»–é…ç½®
  silentTranslationWarn: false,  // æ˜¾ç¤ºç¿»è¯‘è­¦å‘Š
  silentFallbackWarn: false,     // æ˜¾ç¤ºå›é€€è­¦å‘Š
  missingWarn: true,             // æ˜¾ç¤ºç¼ºå¤±è­¦å‘Š
  fallbackWarn: true,            // æ˜¾ç¤ºå›é€€è­¦å‘Š
})
```

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

```typescript
// tests/i18n.spec.ts
import { mount } from '@vue/test-utils'
import { createI18n } from 'vue-i18n'

describe('i18n Component', () => {
  const i18n = createI18n({
    legacy: false,
    locale: 'zh_CN',
    messages: {
      zh_CN: { hello: 'ä½ å¥½' },
      en: { hello: 'Hello' }
    }
  })

  it('renders correct translation', () => {
    const wrapper = mount(TestComponent, {
      global: { plugins: [i18n] }
    })
    expect(wrapper.text()).toContain('ä½ å¥½')
  })

  it('switches language correctly', async () => {
    i18n.global.locale.value = 'en'
    await wrapper.vm.$nextTick()
    expect(wrapper.text()).toContain('Hello')
  })
})
```

### E2E æµ‹è¯•

```typescript
// tests/e2e/i18n.spec.ts
test('language switching works', async ({ page }) => {
  await page.goto('/login')
  
  // æ£€æŸ¥é»˜è®¤è¯­è¨€
  await expect(page.locator('.login-title')).toHaveText('ç™»å½•')
  
  // åˆ‡æ¢è¯­è¨€
  await page.click('.language-switcher')
  await page.click('[data-lang="en"]')
  
  // æ£€æŸ¥è¯­è¨€åˆ‡æ¢æ•ˆæœ
  await expect(page.locator('.login-title')).toHaveText('Login')
})
```

## æ‰©å±•å¼€å‘

### æ·»åŠ æ–°è¯­è¨€

1. **åˆ›å»ºè¯­è¨€åŒ…æ–‡ä»¶**:
```bash
# åœ¨ src/locales/ ä¸‹åˆ›å»ºæ–°è¯­è¨€æ–‡ä»¶
touch src/locales/ja[æ—¥æœ¬èª].yaml
```

2. **æ·»åŠ ç¿»è¯‘å†…å®¹**:
```yaml
# ja[æ—¥æœ¬èª].yaml
loginForm:
  loginButton: ãƒ­ã‚°ã‚¤ãƒ³
  passwordPlaceholder: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
  
crud:
  save: ä¿å­˜
  cancel: ã‚­ãƒ£ãƒ³ã‚»ãƒ«
```

3. **æ›´æ–°è¯­è¨€é…ç½®**:
```typescript
// å¦‚æœéœ€è¦ï¼Œåœ¨åˆå§‹åŒ–æ—¶æ·»åŠ æ–°è¯­è¨€æ”¯æŒ
const supportedLocales = ['zh_CN', 'en', 'zh_TW', 'ja']
```

### è‡ªå®šä¹‰ç¿»è¯‘é€»è¾‘

```typescript
// åˆ›å»ºè‡ªå®šä¹‰ç¿»è¯‘ Hook
export function useCustomTrans() {
  const { t, te } = useI18n()
  
  return {
    t: (key: string, fallback?: string) => {
      if (te(key)) {
        return t(key)
      }
      
      // è‡ªå®šä¹‰å›é€€é€»è¾‘
      if (fallback) {
        return fallback
      }
      
      // è®°å½•ç¼ºå¤±çš„ç¿»è¯‘é”®
      console.warn(`Missing translation: ${key}`)
      return key
    }
  }
}
```

## æœ€ä½³å®è·µ

### 1. é”®åå‘½åè§„èŒƒ

```yaml
# æ¨èï¼šä½¿ç”¨å‘½åç©ºé—´å’Œè¯­ä¹‰åŒ–å‘½å
user:
  profile:
    title: ä¸ªäººèµ„æ–™
    edit: ç¼–è¾‘èµ„æ–™
  management:
    title: ç”¨æˆ·ç®¡ç†
    create: åˆ›å»ºç”¨æˆ·

# é¿å…ï¼šè¿‡äºæ‰å¹³çš„ç»“æ„
userProfileTitle: ä¸ªäººèµ„æ–™
userProfileEdit: ç¼–è¾‘èµ„æ–™
```

### 2. ç»„ä»¶è®¾è®¡

```vue
<!-- æ¨èï¼šå°†ç¿»è¯‘é€»è¾‘å°è£…åœ¨ç»„ä»¶å†…éƒ¨ -->
<template>
  <div class="user-card">
    <h3>{{ title }}</h3>
    <p>{{ description }}</p>
  </div>
</template>

<script setup lang="ts">
interface Props {
  userId: string
}

const props = defineProps<Props>()
const { t } = useLocalTrans()

const title = computed(() => t('title'))
const description = computed(() => t('description', { id: props.userId }))
</script>

<i18n lang="yaml">
zh_CN:
  title: ç”¨æˆ·ä¿¡æ¯
  description: ç”¨æˆ·IDï¼š{id}
en:
  title: User Info
  description: User ID: {id}
</i18n>
```

### 3. æ€§èƒ½è€ƒè™‘

```typescript
// æ¨èï¼šç¼“å­˜è®¡ç®—ç»“æœ
const translatedOptions = computed(() => {
  return options.map(option => ({
    ...option,
    label: t(`options.${option.key}`)
  }))
})

// é¿å…ï¼šåœ¨æ¸²æŸ“å‡½æ•°ä¸­é‡å¤è°ƒç”¨ç¿»è¯‘
// {{ options.map(opt => t(`options.${opt.key}`)) }}
```