# 使用示例

在代码中使用数据权限、目前支持多种方式进行动态开启与关闭。
以下举几种常见的开发案例

## 对整个模型进行数据权限控制

以默认的 `User` 模型为例，假设我们需要对 `User` 模型进行数据权限控制。

可以在 `User` 模型中 use  `DataScopes` trait 来启用数据权限作用域。

```php

use App\Library\DataPermission\Scope\DataScopes;

class User {}
    // 使用数据权限作用域
    use DataScopes;

    // 其他代码...
}
```

这样会使所有对 `User` 模型的查询都自动应用数据权限控制。

### 对某个代码块进行数据权限控制

得益于 Hyperf Aop 特性，我们可以在类或者类方法上使用 [DataScope](https://github.com/mineadmin/MineAdmin/blob/master-department/app/Library/DataPermission/Attribute/DataScope.php) 注解来对指定的代码块开启数据权限控制。 

以自带的用户模块的[分页列表](https://github.com/mineadmin/MineAdmin/blob/master-department/app/Service/Permission/UserService.php#L93~L100)为例

```php
class UserService
{
    #[DataScope(
        scopeType: ScopeType::CREATED_BY,
        onlyTables: ['user']
    )]
    public function page(array $params, int $page = 1, int $pageSize = 10): array
    {
        return parent::page($params, $page, $pageSize); // TODO: Change the autogenerated stub
    }
}
```

这样在调用 `page` 方法时，数据权限会自动应用到查询中。
