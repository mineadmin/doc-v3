# 使用示例

在程式碼中使用資料許可權、目前支援多種方式進行動態開啟與關閉。
以下舉幾種常見的開發案例

## 對整個模型進行資料許可權控制

以預設的 `User` 模型為例，假設我們需要對 `User` 模型進行資料許可權控制。

可以在 `User` 模型中 use  `DataScopes` trait 來啟用資料許可權作用域。

```php

use App\Library\DataPermission\Scope\DataScopes;

class User {}
    // 使用資料許可權作用域
    use DataScopes;

    // 其他程式碼...
}
```

這樣會使所有對 `User` 模型的查詢都自動應用資料許可權控制。

### 對某個程式碼塊進行資料許可權控制

得益於 Hyperf Aop 特性，我們可以在類或者類方法上使用 [DataScope](https://github.com/mineadmin/MineAdmin/blob/master-department/app/Library/DataPermission/Attribute/DataScope.php) 註解來對指定的程式碼塊開啟資料許可權控制。 

以自帶的使用者模組的[分頁列表](https://github.com/mineadmin/MineAdmin/blob/master-department/app/Service/Permission/UserService.php#L93~L100)為例

```php
class UserService
{
    #[DataScope(
        scopeType: ScopeType::CREATED_BY,
        onlyTables: ['user']
    )]
    public function page(array $params, int $page = 1, int $pageSize = 10): array
    {
        return parent::page($params, $page, $pageSize); // TODO: Change the autogenerated stub
    }
}
```

這樣在呼叫 `page` 方法時，資料許可權會自動應用到查詢中。
