# 使用示例

在代碼中使用數據權限、目前支持多種方式進行動態開啓與關閉。
以下舉幾種常見的開發案例

## 對整個模型進行數據權限控制

以默認的 `User` 模型為例，假設我們需要對 `User` 模型進行數據權限控制。

可以在 `User` 模型中 use  `DataScopes` trait 來啓用數據權限作用域。

```php

use App\Library\DataPermission\Scope\DataScopes;

class User {}
    // 使用數據權限作用域
    use DataScopes;

    // 其他代碼...
}
```

這樣會使所有對 `User` 模型的查詢都自動應用數據權限控制。

### 對某個代碼塊進行數據權限控制

得益於 Hyperf Aop 特性，我們可以在類或者類方法上使用 [DataScope](https://github.com/mineadmin/MineAdmin/blob/master-department/app/Library/DataPermission/Attribute/DataScope.php) 註解來對指定的代碼塊開啓數據權限控制。 

以自帶的用户模塊的[分頁列表](https://github.com/mineadmin/MineAdmin/blob/master-department/app/Service/Permission/UserService.php#L93~L100)為例

```php
class UserService
{
    #[DataScope(
        scopeType: ScopeType::CREATED_BY,
        onlyTables: ['user']
    )]
    public function page(array $params, int $page = 1, int $pageSize = 10): array
    {
        return parent::page($params, $page, $pageSize); // TODO: Change the autogenerated stub
    }
}
```

這樣在調用 `page` 方法時，數據權限會自動應用到查詢中。
